/*!
 * tiny-popup-menu - v1.0.2
 * https://github.com/GastonZalba/tiny-popup-menu#readme
 * Built: Fri Sep 01 2023 12:21:22 GMT-0300 (Argentina Standard Time)
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).TinyPopupMenu=e()}(this,(function(){"use strict";var t={exports:{}};function e(){}e.prototype={on:function(t,e,s){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:s}),this},once:function(t,e,s){var n=this;function i(){n.off(t,i),e.apply(s,arguments)}return i._=e,this.on(t,i,s)},emit:function(t){for(var e=[].slice.call(arguments,1),s=((this.e||(this.e={}))[t]||[]).slice(),n=0,i=s.length;n<i;n++)s[n].fn.apply(s[n].ctx,e);return this},off:function(t,e){var s=this.e||(this.e={}),n=s[t],i=[];if(n&&e)for(var o=0,r=n.length;o<r;o++)n[o].fn!==e&&n[o].fn._!==e&&i.push(n[o]);return i.length?s[t]=i:delete s[t],this}},t.exports=e;var s=t.exports.TinyEmitter=e;function n(t,e={},...s){if("function"==typeof t)return t(e,s);const n=null===t?new DocumentFragment:document.createElement(t);Object.entries(e||{}).forEach((([t,e])=>{void 0!==typeof e&&null!=e&&(t.startsWith("on")&&t.toLowerCase()in window?n.addEventListener(t.toLowerCase().substr(2),e):"className"===t?n.setAttribute("class",e.toString()):"htmlFor"===t?n.setAttribute("for",e.toString()):n.setAttribute(t,e.toString()))}));for(const t of s)t&&(Array.isArray(t)?n.append(...t):void 0===t.nodeType?n.innerHTML+=t:n.appendChild(t));return n}const i="popup-menu",o=i+"--container",r=i+"--active",a=i+"--show-arrow",c=i+"--show-arrow-top",l=i+"--show-arrow-bottom",h=i+"--item",u=i+"--item-separator";let p=1;const d=(t,...e)=>(e.forEach((e=>{Object.keys(e).forEach((s=>{const n=e[s],i=t[s];t[s]=i&&n&&"object"==typeof i&&"object"==typeof n&&!Array.isArray(i)?d(i,n):n}))})),t);class f extends s{constructor(t=null){super(),this._isOpen=!1,this._containerMenu=n("div",{id:`${i}-${p}`}),this._instanceOptions=this._parseOptions(t),p++}open(t){if(this._options=this._parseOptions(t),this._isOpen&&(this.close(),t.event.currentTarget===this._toggler))return void(this._options.stopClick&&(t.event.preventDefault(),t.event.stopPropagation()));const{event:e,menuItems:s,autoClose:i,stopClick:o}=this._options;this._toggler=e.currentTarget,this._menuItemsList=s.map((t=>"-"===t?n("span",{className:u}):n("div",{className:h+" "+(t.className||""),onClick:t.callback?e=>{t.callback(e),i&&this.close()}:null,id:t.id,style:t.style},t.content))),this._isOpen=!0,this.updatePosition(),setTimeout((()=>{this.addEventListeners()})),this.emit("open"),o&&(e.preventDefault(),e.stopPropagation())}close(){this._containerMenu.innerHTML="",this._containerMenu.remove(),this._toggler.classList.remove(r),this._isOpen=!1,this.removeEventListeners(),this.emit("close")}updatePosition(t=!0){if(!this._isOpen)return;const{offset:e,className:s,arrow:c,position:l,margin:h}=this._options;this._containerMenu.style.position="fixed",this._containerMenu.className=s,this._containerMenu.classList.add(i),c&&this._containerMenu.classList.add(a),this._containerMenu.innerHTML="",this._containerMenu.append(n("div",{className:o},...this._menuItemsList)),document.body.append(this._containerMenu);const u=this._toggler.getBoundingClientRect(),p=this._toggler.offsetHeight,d=this._toggler.offsetWidth,f=(null==e?void 0:e.x)||0,m=(null==e?void 0:e.y)||0,_=this._containerMenu.offsetHeight,v=this._containerMenu.offsetWidth,g=(()=>{if("top"===l){if(u.top+_+m+h<=0)return"bottom"}else if("bottom"===l&&u.top+_+m+p+h>=document.documentElement.scrollHeight)return"top";return l})();let y=0,L=0;switch(g){case"bottom":y=m+p+h,L=-v/2+d/2;break;case"top":y=-_-h,L=-v/2+d/2}const b=window.innerWidth,w=u.left+f+L;let M=0;w<0?M=0-w+h:w+v>b&&(M=b-(w+v)-h),this._containerMenu.style.left=w+M+"px",this._containerMenu.style.top=u.top+y+"px",this._toggler.classList.add(r),c&&(this._containerMenu.style.setProperty("--ofx",`${M+5}px`),this._evaluateArrowPosition(g)),t||this.emit("updateposition")}addToggler(t,e={},s="click"){"contextmenu"===s?t.addEventListener("contextmenu",(t=>this.open(Object.assign(Object.assign({},e),{event:t})))):t.addEventListener("click",(t=>this.open(Object.assign(Object.assign({},e),{event:t}))))}_parseOptions(t){const e={position:"bottom",className:"",autoClose:!0,arrow:!0,margin:!("arrow"in(t||{}))||t.arrow?10:2,offset:{x:0,y:0},menuItems:[],stopClick:!0};return d({},e,this._instanceOptions||{},t||{})}_evaluateArrowPosition(t){let e="";switch(t){case"bottom":e=c;break;case"top":e=l}this._containerMenu.classList.add(e)}addEventListeners(){this._closeListener=t=>{this._containerMenu.contains(t.target)||this.close()},this._resizeListener=()=>{this._isOpen&&this.updatePosition(!1)},document.addEventListener("click",this._closeListener),window.addEventListener("resize",this._resizeListener)}removeEventListeners(){document.removeEventListener("click",this._closeListener),window.removeEventListener("resize",this._resizeListener)}}var m=Object.freeze({__proto__:null,default:f});return Object.assign(f,m),f}));
//# sourceMappingURL=tiny-popup-menu.min.js.map
