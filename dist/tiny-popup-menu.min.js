/*!
 * tiny-popup-menu - v1.0.8
 * https://github.com/GastonZalba/tiny-popup-menu#readme
 * Built: Thu Sep 14 2023 18:28:30 GMT-0300 (Argentina Standard Time)
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).TinyPopupMenu=e()}(this,(function(){"use strict";var t={exports:{}};function e(){}e.prototype={on:function(t,e,s){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:s}),this},once:function(t,e,s){var n=this;function i(){n.off(t,i),e.apply(s,arguments)}return i._=e,this.on(t,i,s)},emit:function(t){for(var e=[].slice.call(arguments,1),s=((this.e||(this.e={}))[t]||[]).slice(),n=0,i=s.length;n<i;n++)s[n].fn.apply(s[n].ctx,e);return this},off:function(t,e){var s=this.e||(this.e={}),n=s[t],i=[];if(n&&e)for(var o=0,r=n.length;o<r;o++)n[o].fn!==e&&n[o].fn._!==e&&i.push(n[o]);return i.length?s[t]=i:delete s[t],this}},t.exports=e;var s,n,i=t.exports.TinyEmitter=e;function o(t,e={},...s){if("function"==typeof t)return t(e,s);const n=null===t?new DocumentFragment:document.createElement(t);Object.entries(e||{}).forEach((([t,e])=>{void 0!==typeof e&&null!=e&&(t.startsWith("on")&&t.toLowerCase()in window?n.addEventListener(t.toLowerCase().substr(2),e):"className"===t?n.setAttribute("class",e.toString()):"htmlFor"===t?n.setAttribute("for",e.toString()):n.setAttribute(t,e.toString()))}));for(const t of s)t&&(Array.isArray(t)?n.append(...t):void 0===t.nodeType?n.innerHTML+=t:n.appendChild(t));return n}!function(t){t.Top="top",t.Bottom="bottom"}(s||(s={})),function(t){t.Left="left",t.Right="right"}(n||(n={}));const r={position:s.Bottom,className:"",autoClose:!0,arrow:!0,margin:void 0,offset:{x:0,y:0},menuItems:[],stopClick:!0};const a="popup-menu",c=a+"--container",l=a+"--active",h=a+"--show-arrow",u=a+"--show-arrow-top",p=a+"--show-arrow-bottom",d=a+"--item",m=a+"--submenu",f=a+"--submenu-arrow",g=a+"--submenu-content",v=a+"--item-separator";let _=1;const w=(t,...e)=>(e.forEach((e=>{Object.keys(e).forEach((s=>{const n=e[s],i=t[s];t[s]=i&&n&&"object"==typeof i&&"object"==typeof n&&!Array.isArray(i)?w(i,n):n}))})),t);class L extends i{constructor(t=null){super(),this._isOpen=!1,this._containerMenu=o("div",{id:`${a}-${_}`}),this._instanceOptions=t,_++}open(t){if(this._options=this._parseOptions(t),this.isOpen()&&(this.close(),t.event.currentTarget===this._toggler))return void(this._options.stopClick&&(t.event.preventDefault(),t.event.stopPropagation()));const{event:e,menuItems:s,autoClose:n,stopClick:i}=this._options;this._toggler=e.currentTarget;let r=!1;this._menuItemsList=s.map((t=>"-"===t?o("span",{className:v}):"items"in t?(r=!0,this._processSubMenu(t,n)):this._processMenuItem(t,n))),this._isOpen=!0,this.updatePosition(),r&&this._updateSubmenusPosition(),setTimeout((()=>{this.addEventListeners()})),this.emit("open"),i&&(e.preventDefault(),e.stopPropagation())}close(){this.isOpen()&&(this._containerMenu.innerHTML="",this._containerMenu.remove(),this._toggler.classList.remove(l),this.removeEventListeners(),this._isOpen=!1,this.emit("close"))}updatePosition(t=!0){if(!this.isOpen())return;const{offset:e,className:n,arrow:i,position:r,margin:u}=this._options;this._containerMenu.style.position="fixed",this._containerMenu.className=n,this._containerMenu.classList.add(a),i&&this._containerMenu.classList.add(h),this._containerMenu.innerHTML="",this._containerMenu.append(o("div",{className:c},...this._menuItemsList)),document.body.append(this._containerMenu);const p=this._toggler.getBoundingClientRect(),d=this._toggler.offsetHeight,m=this._toggler.offsetWidth,f=(null==e?void 0:e.x)||0,g=(null==e?void 0:e.y)||0,v=this._containerMenu.offsetHeight,_=this._containerMenu.offsetWidth,w=(()=>{if(r===s.Top){if(p.top-v-g-u<=0)return s.Bottom}else if(r===s.Bottom&&p.top+v+g+d+u>=document.documentElement.offsetHeight)return s.Top;return r})();let L=0;switch(w){case s.Bottom:L=g+d+u;break;case s.Top:L=-v-u}const y=-_/2+m/2,M=window.innerWidth,b=p.left+f+y;let x=0;if(b<0?x=0-b+u:b+_>M&&(x=M-(b+_)-u),this._containerMenu.style.left=b+x+"px",this._containerMenu.style.top=p.top+L+"px",this._toggler.classList.add(l),i){const t=8,e=3;x=x>0?Math.min(_/2-t-e,x):Math.max(-(_/2-2*(t+e)),x),this._containerMenu.style.setProperty("--ofx",`${x+t}px`),this._evaluateArrowPosition(w)}t||this.emit("updateposition")}addToggler(t,e={},s="click"){"contextmenu"===s?t.addEventListener("contextmenu",(t=>this.open(Object.assign(Object.assign({},e),{event:t})))):t.addEventListener("click",(t=>this.open(Object.assign(Object.assign({},e),{event:t}))))}isOpen(){return this._isOpen}_parseOptions(t){const e=w({},r,this._instanceOptions||{},t||{});return void 0===e.margin&&(e.margin=!("arrow"in e)||e.arrow?10:2),e}_processSubMenu(t,e){return o("div",{className:m+" "+(t.className||""),id:t.id,style:t.style,"data-position":t.position||n.Right},o("span",null,t.content),o("div",{className:f}),o("div",{className:g},t.items.map((t=>this._processMenuItem(t,e)))))}_processMenuItem(t,e){return o("div",{className:d+" "+(t.className||""),onClick:t.callback?s=>{t.callback(s),e&&this.close()}:null,id:t.id,style:t.style},t.content)}_updateSubmenusPosition(){this._containerMenu.querySelectorAll("."+m).forEach((t=>{const e=t.dataset.position,s=t.querySelector("."+g),i=s.getBoundingClientRect(),o=s.offsetWidth,r=(()=>{if(e===n.Left){if(i.right-o<=0)return n.Right}else if(e===n.Right&&i.right+o>=document.documentElement.offsetWidth)return n.Left;return e})();t.classList.add(m+"-"+r);const a=t.querySelector("."+f);a.innerHTML="",r===n.Left?a.append((new DOMParser).parseFromString('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="768" height="768" viewBox="0 0 768 768">\r\n<path d="M493.5 531l-45 45-192-192 192-192 45 45-147 147z"></path>\r\n</svg>\r\n',"image/svg+xml").firstChild):e===n.Right&&a.append((new DOMParser).parseFromString('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="768" height="768" viewBox="0 0 768 768">\r\n<path d="M274.5 531l147-147-147-147 45-45 192 192-192 192z"></path>\r\n</svg>\r\n',"image/svg+xml").firstChild)}))}_evaluateArrowPosition(t){let e="";switch(t){case s.Bottom:e=u;break;case s.Top:e=p}this._containerMenu.classList.add(e)}addEventListeners(){this._closeListener=t=>{this._containerMenu.contains(t.target)||this.close()},this._resizeListener=()=>{this.isOpen()&&this.updatePosition(!1)},this._scrollListener=t=>{this.isOpen()&&t.target.contains(this._toggler)&&this.updatePosition(!1)},document.addEventListener("click",this._closeListener),window.addEventListener("resize",this._resizeListener),window.addEventListener("scroll",this._scrollListener,!0)}removeEventListeners(){document.removeEventListener("click",this._closeListener),window.removeEventListener("resize",this._resizeListener),window.removeEventListener("scroll",this._scrollListener)}}var y=Object.freeze({__proto__:null,get Position(){return s},get SubmenuPosition(){return n},default:L});return Object.assign(L,y),L}));
//# sourceMappingURL=tiny-popup-menu.min.js.map
